<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PNB FINANCE Bank Transaction Receipt</title>
  <style>
    :root {
      --primary: #0b3c8c;
      --primary-dark: #082c66;
      --success: #28a745;
      --text: #333;
      --light: #f8f9fa;
    }

    * { box-sizing: border-box; }
    body {
      font-family: Arial, Helvetica, sans-serif;
      background: #efefef;
      margin: 0;
      padding: 16px 8px;
      color: var(--text);
      min-height: 100vh;
    }

    .container {
      max-width: 480px;
      margin: 20px auto;
      background: white;
      padding: 24px 18px;
      border-radius: 10px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.12);
      position: relative;
    }

    @media (min-width: 600px) {
      .container { padding: 32px 28px; max-width: 520px; }
    }

    svg { display: block; margin: 0 auto 20px; }

    h3 {
      text-align: center;
      margin: 0 0 24px;
      padding-bottom: 12px;
      border-bottom: 1px solid #ddd;
      color: var(--primary);
      font-size: clamp(15px, 4.2vw, 17px);
    }

    label {
      font-size: 13px;
      font-weight: bold;
      margin: 14px 0 5px;
      display: block;
      color: #444;
    }

    input, select {
      width: 100%;
      padding: 12px 14px;
      margin-top: 3px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 15px;
      background: var(--light);
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(11,60,140,0.15);
    }

    button {
      margin-top: 28px;
      width: 100%;
      padding: 14px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }

    button:hover:not(:disabled) { background: var(--primary-dark); }
    button:disabled { background: #6c757d; cursor: not-allowed; }

    /* Loader Overlay */
    #loader {
      position: absolute;
      inset: 0;
      background: rgba(255,255,255,0.92);
      display: none;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      z-index: 10;
    }

    .spinner {
      width: 48px;
      height: 48px;
      border: 5px solid #e0e0e0;
      border-top: 5px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    #status {
      margin-top: 16px;
      padding: 12px;
      border-radius: 6px;
      font-size: 14px;
      text-align: center;
      display: none;
    }

    #status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
      display: block;
    }

    @media (max-width: 480px) {
      body { padding: 12px 6px; }
      .container { padding: 20px 16px; border-radius: 8px; }
      input, select { padding: 13px 14px; font-size: 16px; }
      button { padding: 16px; font-size: 17px; }
    }
  </style>
</head>
<body>

<div class="container">
  <svg width="110" height="36" viewBox="0 0 120 40" style="margin-bottom:20px;">
    <rect x="0" y="0" width="40" height="40" rx="6" fill="#0b3c8c"/>
    <text x="20" y="26" text-anchor="middle" fill="#fff" font-size="18" font-weight="bold">PNB</text>
    <text x="52" y="26" fill="#0b3c8c" font-size="18" font-weight="bold">BANK</text>
  </svg>

  <h3>Online Banking<br>Transaction Receipt</h3>

  <label>Bank Name</label>
  <input id="bankName" value="PNB PARIBAS BANK">

  <label>Payer Name</label>
  <input id="payerName" placeholder="Enter payer full name">

  <label>Payer Account</label>
  <input id="payerAccount" placeholder="e.g. 0123456789">

  <label>Payer Bank</label>
  <input id="payerBank" placeholder="e.g. Zenith Bank">

  <label>Receiver Name</label>
  <input id="receiverName" placeholder="Enter receiver name">

  <label>Receiver Account</label>
  <input id="receiverAccount" placeholder="e.g. 9876543210">

  <label>Receiver Bank</label>
  <input id="receiverBank" placeholder="e.g. GTBank">

  <label>Currency</label>
  <select id="currency">
    <option value="EUR" selected>€ EUR</option>
    <option value="USD">$ USD</option>
    <option value="GBP">£ GBP</option>
    <option value="NGN">₦ NGN</option>
  </select>

  <label>Amount</label>
  <input id="amount" placeholder="e.g. 1,250.00" inputmode="decimal">

  <label>Transaction Type</label>
  <input id="type" placeholder="e.g. Transfer, Payment">

  <label>Narration / Purpose</label>
  <input id="narration" placeholder="e.g. Payment for services">

  <button id="generateBtn" onclick="generatePDF()">Generate PDF Receipt</button>

  <div id="loader"><div class="spinner"></div></div>

  <div id="status"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>

<script>
const { jsPDF } = window.jspdf;
const btn = document.getElementById("generateBtn");
const loader = document.getElementById("loader");
const statusDiv = document.getElementById("status");

function randomRef() {
  return "PNB" + Date.now().toString().slice(-10);
}

function currentDateTime() {
  return new Date().toLocaleString('en-GB', { hour12: true });
}

function clearForm() {
  const inputs = document.querySelectorAll('input:not(#bankName), select');
  inputs.forEach(el => {
    if (el.type !== 'button') el.value = '';
  });
  document.getElementById("currency").value = "EUR";
}

function showStatus(message, isSuccess = true) {
  statusDiv.textContent = message;
  statusDiv.className = isSuccess ? 'success' : '';
  statusDiv.style.display = 'block';
  setTimeout(() => { statusDiv.style.display = 'none'; }, 8000);
}

async function generatePDF() {
  btn.disabled = true;
  loader.style.display = 'flex';
  statusDiv.style.display = 'none';

  try {
    const doc = new jsPDF();
    let y = 22;

    const bankName = document.getElementById("bankName").value.trim() || "PNB PARIBAS BANK";
    const receiptNo = randomRef();
    const dateTime = currentDateTime();

    const currencyMap = { USD:"$", NGN:"₦", EUR:"€", GBP:"£" };
    const currency = document.getElementById("currency").value;
    const symbol = currencyMap[currency] || "€";

    // WATERMARK
    doc.setTextColor(220, 220, 220);
    doc.setFontSize(48);
    doc.text(bankName, 105, 145, { align: "center", angle: 30 });
    doc.setTextColor(0);

    // HEADER
    doc.setFontSize(16);
    doc.setFont("helvetica", "bold");
    doc.text(bankName, 105, y, { align: "center" });
    y += 8;

    doc.setFontSize(11);
    doc.setFont("helvetica", "normal");
    doc.text("Online Banking Transaction Receipt", 105, y, { align: "center" });
    y += 14;

    doc.setLineWidth(0.4);
    doc.line(18, y, 192, y);
    y += 12;

    function row(label, value) {
      doc.setFont("helvetica", "bold");
      doc.setFontSize(11);
      doc.text(label + ":", 20, y);
      doc.setFont("helvetica", "normal");
      doc.text(String(value || "-"), 105, y);
      y += 9;
    }

    row("Receipt No", receiptNo);
    row("Date & Time", dateTime);
    row("Payer", document.getElementById("payerName").value);
    row("Payer Account", document.getElementById("payerAccount").value);
    row("Payer Bank", document.getElementById("payerBank").value);

    y += 6;
    row("Receiver", document.getElementById("receiverName").value);
    row("Receiver Account", document.getElementById("receiverAccount").value);
    row("Receiver Bank", document.getElementById("receiverBank").value);

    y += 6;
    row("Amount", symbol + " " + (document.getElementById("amount").value || "0.00"));
    row("Type", document.getElementById("type").value);
    row("Narration", document.getElementById("narration").value);
    row("Status", "SUCCESSFUL");

    // QR
    const qr = qrcode(0, 'L');
    qr.addData(`${bankName} | Ref: ${receiptNo}`);
    qr.make();
    const qrDataURL = qr.createDataURL(4);
    doc.addImage(qrDataURL, "PNG", 155, y + 5, 28, 28);

    y += 45;

    doc.setFontSize(9);
    doc.setTextColor(80);
    doc.text(
      "Electronic receipt – no signature required.\n" +
      "Verify with bank if needed.\n" +
      "Support: https://line.me/ti/p/s_v9UeheMS\n" +
      "",
      105, y,
      { align: "center", maxWidth: 160, lineHeightFactor: 1.4 }
    );

    doc.save(`PNB_Transfer_Receipt_${receiptNo}.pdf`);

    // Success feedback
    showStatus("PDF downloaded! Reminder: Do NOT reuse or duplicate this receipt — each is unique and traceable.");
    clearForm();

  } catch (err) {
    console.error(err);
    showStatus("Error generating PDF. Please try again.", false);
  } finally {
    loader.style.display = 'none';
    btn.disabled = false;
  }
}
</script>
</body>

</html>
